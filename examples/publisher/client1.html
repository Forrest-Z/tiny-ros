<!DOCTYPE HTML>
<html>
  <head>
  <meta charset="utf-8">
  <script type='text/javascript' src='tiny-ros/build/output/client_library/js/test_js/Test.js'></script>
  <script type="text/javascript">
    window.count = 0;
    window.ws = new WebSocket("ws://127.0.0.1:11318");
    window.ws.binaryType = "arraybuffer";
    ws.onopen = function() {
      console.log("Opening...");
    };
                
    ws.onmessage = function (evt) {
      var data = new Uint8Array(evt.data);
      console.log(new Uint8Array(evt.data));
      if (data != 0xFF) {
      var testJs = test_js.TestRequest();
      testJs.deserialize(new Uint8Array(evt.data), 0);
      console.log("StringArray[0]: " + testJs.StringArray[0].data);
      console.log("StringArray[1]: " + testJs.StringArray[1].data);
      console.log("String3Array[0]: " + testJs.String3Array[0].data);
      console.log("String3Array[1]: " + testJs.String3Array[1].data);
      console.log("String3Array[2]: " + testJs.String3Array[2].data + "\n\n");
      }
    };
    
    ws.onclose = function() { 
      console.log("Clossing..."); 
    };
  </script>
  <script type="text/javascript">
    function WebSocketTest() {
      var buff = new Uint8Array(98);
      var testJs = test_js.TestRequest();
      testJs.StringArray[0] = std_msgs.String();
      testJs.StringArray[1] = std_msgs.String();
      testJs.StringArray[0].data = "StringArray 000";
      testJs.StringArray[1].data = "StringArray 1";
      testJs.String3Array[0].data = "String3Array 0";
      testJs.String3Array[1].data = "String3Array 1";
      testJs.String3Array[2].data = "String3Array 2";
      console.log("length: " + testJs.serializedLength());
      testJs.serialize(buff, 0);
      window.ws.send(buff);
    }
  </script>
        
   </head>
   <body>
   
      <div id="sse">
         <a href="javascript:WebSocketTest()">WebSocket Send</a>
      </div>
      
   </body>
</html>
